(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function m(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=m(s);fetch(s.href,i)}})();const w="/super-six-tracker/assets/super-six-scores.eaa2b6b8.csv",B="/super-six-tracker/assets/football.b99eb6b5.svg";document.querySelector("#app").innerHTML=`
  <div id="title">
    <img id="football" src="" alt="Logo" width="60" height="60"/>
    <h1>Super 6 League Tracker</h1>
  </div>
  <h2>QUE SERA SERA, WE'RE GOING TO WORMBELLY</h2>
  <div id="seasons">
    <label for="season">Season:</label>
    <select name="season" id="season-select">
      <option value="24-25" selected>2024/2025</option>
      <option value="23-24">2023/2024</option>
      <option value="22-23">2022/2023</option>
    </select>
  </div>
  <p>Click each name to toggle data series.</p>
  <div id="legend-container"></div>
  <div id="graph"><div>`;document.getElementById("football").src=B;const d={top:20,right:80,bottom:40,left:80},x=800-d.left-d.right,M=500-d.top-d.bottom,k=x/M;let u=null,h=null;function I(r,n){const m=window.innerWidth,o=window.innerHeight;return m/o>k?(n=M,r=x):(r=m+d.left,n=r/k),[r,n]}[u,h]=I();const $=`<table id="stats-table" width=${u*1.2}>
<thead>
    <tr id="name-header">
      <th></th>
    </tr>
</thead>
<tbody>
    <tr id="max-round-score"></tr>
    <tr id="avg-round-score"></tr>
    <tr id="standard-dev"></tr>
    <tr id="rounds-won"></tr>
</tbody>
</table>`,H=document.getElementById("season-select");H.addEventListener("change",j);j();function j(){document.getElementById("legend-container").innerHTML="",document.getElementById("graph").innerHTML="";const r=H.value,n=d3.select("#graph").append("svg").attr("width",`${u+d.left+d.right}px`).attr("height",`${h+d.top+d.bottom}px`).append("g").attr("transform",`translate(${d.left}, ${d.top})`),m=d3.select("#legend-container").style("width",`${u}px`);d3.csv(w).then(function(o){const s=["andy","david","jake","james","jonnie","josh","sam"],i=["andy","david","ed","jack","jake","james","jonnie","josh","sam"],f=["andy","david","ed","jack","jake","james","jonnie","josh","sam","tom"];let p=null;switch(r){case"22-23":p=s.map(function(e){return{name:e,values:o.filter(function(l){return l.name===e}).map(function(l){return{round:+l.round,score:+l.score,score_sum:+l.score_sum}})}});break;case"23-24":p=i.map(function(e){return{name:e,values:o.filter(function(l){return l.s2_name===e}).map(function(l){return{round:+l.s2_round,score:+l.s2_score,score_sum:+l.s2_score_sum}})}});break;case"24-25":p=f.map(function(e){return{name:e,values:o.filter(function(l){return l.s3_name===e}).map(function(l){return{round:+l.s3_round,score:+l.s3_score,score_sum:+l.s3_score_sum}})}});break;default:console.log("No recognised season toggle!")}function v(){return d3.axisBottom(t).ticks()}function y(){return d3.axisLeft(a).ticks()}const t=d3.scaleLinear().domain(r==="22-23"?[1,d3.max(o,function(e){return+e.round})]:r==="23-24"?[1,d3.max(o,function(e){return+e.s2_round})]:[1,d3.max(o,function(e){return+e.s3_round})]).range([0,u]);n.append("g").attr("transform",`translate(0, ${h})`).style("font-size","0.75rem").call(d3.axisBottom(t).ticks(r==="22-23"?d3.max(o,function(e){return+e.round})/2:r==="23-24"?d3.max(o,function(e){return+e.s2_round})/2:d3.max(o,function(e){return+e.s3_round})/2)),n.append("g").attr("class","grid").attr("transform","translate(0,"+h+")").call(v().tickSize(-h).tickFormat("").ticks(d3.max(o,function(e){return r==="22-23"?+e.round:+e.s2_round})/2)),n.append("text").attr("text-anchor","center").attr("x",(u-50)/2).attr("y",h+d.bottom).text("Round");const a=d3.scaleLinear().domain([d3.min(o,function(e){return r==="22-23"?+e.score_sum:r==="23-24"?+e.s2_score_sum:+e.s3_score_sum}),Math.ceil(d3.max(o,function(e){return r==="22-23"?+e.score_sum:r==="23-24"?+e.s2_score_sum:+e.s3_score_sum})/10)*10]).range([h,0]);n.append("g").style("font-size","0.75rem").call(d3.axisLeft(a).ticks(u===x?d3.max(o,function(e){return+e.score_sum})/40:d3.max(o,function(e){return+e.score_sum})/40)),n.append("g").attr("class","grid").call(y().tickSize(-u).tickFormat("").ticks(u===x?d3.max(o,function(e){return+e.score_sum})/10:d3.max(o,function(e){return+e.score_sum})/10)),n.append("text").attr("text-anchor","center").attr("transform",u===x?"rotate(0)":"rotate(-90)").attr("x",u===x?-d.left:-h/2).attr("y",u===x?h/2:-d.top*2).text("Points");const c=d3.scaleOrdinal().domain(r==="22-23"?s:i).range(d3.schemeTableau10),E=d3.line().x(e=>t(+e.round)).y(e=>a(+e.score_sum)),R=n.selectAll("myLines").data(p).join("path").attr("d",e=>E(e.values)).attr("stroke",e=>c(e.name)).style("stroke-width",2).style("fill","none"),S=m.selectAll("myLabels").data(r==="22-23"?s:r==="23-24"?i:f).enter().append("div").attr("class","legend-label").style("color",e=>c(e)).text(function(e){return e}).style("alignment-baseline","middle").on("click",(e,l)=>{const b=S.selectAll("g")._parents;let L=null;for(let g=0;g<b.length;g++)if(l===b[g].innerHTML){L=b[g];break}const _=R.selectAll("path")._parents;let T=null;for(let g=0;g<_.length;g++)if(c(l)===_[g].attributes.stroke.value){T=_[g];break}d3.select(L).style("opacity",()=>d3.select(L).style("opacity")==="1"?"0.33":"1"),d3.select(T).style("opacity",()=>d3.select(T).style("opacity")==="1"?"0":"1")});N(p)})}function N(r){document.getElementById("stats-table")===null&&(console.log("Table does not exist yet!"),d3.select("#app").append("div").html($),d3.select("#app").append("p").html("* Includes tied winners."));const n=[];for(let t=0;t<r.length;t++){let a=[];for(let c=0;c<r[t].values.length;c++)a.push(r[t].values[c].score);n.push(a)}const m=[];for(let t=0;t<n[0].length;t++){let a=0;for(let c=0;c<n.length;c++)n[c][t]>a&&(a=n[c][t]);m.push(a)}let o=new Array(n.length).fill(0);for(let t=0;t<m.length;t++)for(let a=0;a<n.length;a++)n[a][t]===m[t]&&(o[a]+=1);const s=document.getElementById("name-header"),i=document.getElementById("max-round-score"),f=document.getElementById("avg-round-score"),p=document.getElementById("standard-dev"),v=document.getElementById("rounds-won");let y=[];for(let t=0;t<r.length;t++)y.push(r[t].name);for(let t=0;t<y.length;t++){let a=y[t],c=a.charAt(0).toUpperCase()+a.slice(1);y[t]=c}s.innerHTML="",i.innerHTML="",f.innerHTML="",p.innerHTML="",v.innerHTML="",s.innerHTML="<th></th>";for(let t=0;t<y.length;t++)s.innerHTML+=`<th>${y[t]}</th>`;i.innerHTML="<td>Best Round</td>";for(let t=0;t<n.length;t++)i.innerHTML+=`<td>${d3.max(n[t])}</td>`;f.innerHTML="<td>Avg Round</td>";for(let t=0;t<n.length;t++)f.innerHTML+=`<td>${Math.round(d3.mean(n[t])*10)/10}</td>`;p.innerHTML="<td>Std Dev</td>";for(let t=0;t<n.length;t++)p.innerHTML+=`<td>${Math.round(d3.deviation(n[t])*10)/10}</td>`;v.innerHTML="<td>Rounds Won<sup>*</sup></td>";for(let t=0;t<n.length;t++)v.innerHTML+=`<td>${o[t]}</td>`}
