(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function g(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=g(o);fetch(o.href,r)}})();const I="/super-six-tracker/assets/super-six-scores-B46jSaHE.csv",$="/super-six-tracker/assets/football-BH6fJzOH.svg";document.querySelector("#app").innerHTML=`
  <div id="title">
    <img id="football" src="" alt="Logo" width="60" height="60"/>
    <h1>Super 6 League Tracker</h1>
  </div>
  <h2>QUE SERA SERA, WE'RE GOING TO WORMBELLY</h2>
  <div id="seasons">
    <label for="season">Season:</label>
    <select name="season" id="season-select">
      <option value="25-26" selected>2025/2026</option>
      <option value="24-25">2024/2025</option>
      <option value="23-24">2023/2024</option>
      <option value="22-23">2022/2023</option>
    </select>
  </div>
  <p>Click each name to toggle data series.</p>
  <div id="legend-container"></div>
  <div id="graph"><div>`;document.getElementById("football").src=$;const u={top:20,right:80,bottom:40,left:80},x=800-u.left-u.right,B=500-u.top-u.bottom,S=x/B;let i=null,p=null;function O(n,c){const g=window.innerWidth,s=window.innerHeight;return g/s>S?(c=B,n=x):(n=g+u.left,c=n/S),[n,c]}[i,p]=O();let N=`<table id="stats-table" width=${i*1.2}>
<thead>
    <tr id="name-header">
      <th></th>
    </tr>
</thead>
<tbody id="stats-rows">
    <tr id="max-round-score"></tr>
    <tr id="avg-round-score"></tr>
    <tr id="standard-dev"></tr>
    <tr id="rounds-won"></tr>
</tbody>
</table>`;const R=document.getElementById("season-select");R.addEventListener("change",w);w();function w(){document.getElementById("legend-container").innerHTML="",document.getElementById("graph").innerHTML="";const n=R.value;console.log(`Current season: ${n}`);const c=d3.select("#graph").append("svg").attr("width",`${i+u.left+u.right}px`).attr("height",`${p+u.top+u.bottom}px`).append("g").attr("transform",`translate(${u.left}, ${u.top})`),g=d3.select("#legend-container").style("width",`${i}px`);d3.csv(I).then(function(s){const o=["andy","david","jake","james","jonnie","josh","sam"],r=["andy","david","ed","jack","jake","james","jonnie","josh","sam"],a=["andy","david","ed","jack","jake","james","jonnie","josh","sam"],L=["andy","david","ed","jack","jake","james","jonnie","josh","leo","sam","chatbog"];let m=null;switch(n){case"22-23":m=o.map(function(e){return{name:e,values:s.filter(function(t){return t.name===e}).map(function(t){return{round:+t.round,score:+t.score,score_sum:+t.score_sum}})}});break;case"23-24":m=r.map(function(e){return{name:e,values:s.filter(function(t){return t.s2_name===e}).map(function(t){return{round:+t.s2_round,score:+t.s2_score,score_sum:+t.s2_score_sum}})}});break;case"24-25":m=a.map(function(e){return{name:e,values:s.filter(function(t){return t.s3_name===e}).map(function(t){return{round:+t.s3_round,score:+t.s3_score,score_sum:+t.s3_score_sum,correct_results:+t.s3_correct_results,correct_scores:+t.s3_correct_scores}})}});break;case"25-26":m=L.map(function(e){return{name:e,values:s.filter(function(t){return t.s4_name===e}).map(function(t){return{round:+t.s4_round,score:+t.s4_score,score_sum:+t.s4_score_sum,correct_results:+t.s4_correct_results,correct_scores:+t.s4_correct_scores}})}});break;default:console.log("No recognised season toggle!")}function T(){return d3.axisBottom(h).ticks()}function b(){return d3.axisLeft(_).ticks()}const h=d3.scaleLinear().domain(n==="22-23"?[1,d3.max(s,function(e){return+e.round})]:n==="23-24"?[1,d3.max(s,function(e){return+e.s2_round})]:n==="24-25"?[1,d3.max(s,function(e){return+e.s3_round})]:[1,d3.max(s,function(e){return+e.s4_round})]).range([0,i]);c.append("g").attr("transform",`translate(0, ${p})`).style("font-size","0.75rem").call(d3.axisBottom(h).ticks(n==="22-23"?d3.max(s,function(e){return+e.round})/2:n==="23-24"?d3.max(s,function(e){return+e.s2_round})/2:n==="24-25"?d3.max(s,function(e){return+e.s3_round})/2:d3.max(s,function(e){return+e.s4_round})/2)),c.append("g").attr("class","grid").attr("transform","translate(0,"+p+")").call(T().tickSize(-p).tickFormat("").ticks(d3.max(s,function(e){return n==="22-23"?+e.round:+e.s2_round})/2)),c.append("text").attr("text-anchor","center").attr("x",(i-50)/2).attr("y",p+u.bottom).text("Round");const _=d3.scaleLinear().domain([d3.min(s,function(e){return n==="22-23"?+e.score_sum:n==="23-24"?+e.s2_score_sum:n==="24-25"?+e.s3_score_sum:+e.s4_score_sum}),Math.ceil(d3.max(s,function(e){return n==="22-23"?+e.score_sum:n==="23-24"?+e.s2_score_sum:n==="24-25"?+e.s3_score_sum:+e.s4_score_sum})/10)*10]).range([p,0]);c.append("g").style("font-size","0.75rem").call(d3.axisLeft(_).ticks(i===x?d3.max(s,function(e){return+e.score_sum})/40:d3.max(s,function(e){return+e.score_sum})/40)),c.append("g").attr("class","grid").call(b().tickSize(-i).tickFormat("").ticks(i===x?d3.max(s,function(e){return+e.score_sum})/10:d3.max(s,function(e){return+e.score_sum})/10)),c.append("text").attr("text-anchor","center").attr("transform",i===x?"rotate(0)":"rotate(-90)").attr("x",i===x?-80:-p/2).attr("y",i===x?p/2:-40).text("Points");let y=d3.schemePaired;y[10]=y[11];const v=d3.scaleOrdinal().domain(n==="22-23"?o:r).range(y),H=d3.line().x(e=>h(+e.round)).y(e=>_(+e.score_sum)),d=c.selectAll("myLines").data(m).join("path").attr("d",e=>H(e.values)).attr("stroke",e=>v(e.name)).style("stroke-width",2).style("fill","none"),M=g.selectAll("myLabels").data(n==="22-23"?o:n==="23-24"?r:n==="24-25"?a:L).enter().append("div").attr("class","legend-label").style("color",e=>v(e)).text(function(e){return e}).style("alignment-baseline","middle").on("click",(e,t)=>{const l=M.selectAll("g")._parents;let k=null;for(let f=0;f<l.length;f++)if(t===l[f].innerHTML){k=l[f];break}const j=d.selectAll("path")._parents;let E=null;for(let f=0;f<j.length;f++)if(v(t)===j[f].attributes.stroke.value){E=j[f];break}d3.select(k).style("opacity",()=>d3.select(k).style("opacity")==="1"?"0.33":"1"),d3.select(E).style("opacity",()=>d3.select(E).style("opacity")==="1"?"0":"1")});A(m,n,N)})}function A(n,c,g){if(console.log("Updating the table."),document.getElementById("stats-table")===null&&(console.log("Table does not exist yet!"),d3.select("#app").append("div").html(g),d3.select("#app").append("p").html("* Includes tied winners.")),c==="24-25"||c==="25-26"){let e=document.getElementById("stats-rows");e.innerHTML+=`
    <tr id="correct-results"></tr>
    <tr id="correct-scores"></tr>`}const s=[],o=[];for(let e=0;e<n.length;e++)n[e].values.length<=1?(s.push(n[e].values[0].correct_results),o.push(n[e].values[0].correct_scores)):(s.push(n[e].values.slice(-1)[0].correct_results),o.push(n[e].values.slice(-1)[0].correct_scores));const r=[];for(let e=0;e<n.length;e++){let t=[];for(let l=0;l<n[e].values.length;l++)t.push(n[e].values[l].score);r.push(t)}const a=[];for(let e=0;e<r.length;e++){let t=0;for(let l=0;l<r[e].length;l++)t+=r[e][l];a.push(t)}const L=[];for(let e=0;e<r[0].length;e++){let t=0;for(let l=0;l<r.length;l++)r[l][e]>t&&(t=r[l][e]);L.push(t)}let m=new Array(r.length).fill(0);for(let e=0;e<L.length;e++)for(let t=0;t<r.length;t++)r[t][e]===L[e]&&(m[t]+=1);const T=document.getElementById("name-header"),b=document.getElementById("max-round-score"),h=document.getElementById("avg-round-score"),_=document.getElementById("standard-dev"),y=document.getElementById("rounds-won"),v=document.getElementById("correct-results"),H=document.getElementById("correct-scores");let d=[];for(let e=0;e<n.length;e++)n[e].name==="chatbog"?d.push("&#129484;"):d.push(n[e].name);for(let e=0;e<d.length;e++){let t=d[e];if(t==="&#129484;")continue;let l=t.charAt(0).toUpperCase()+t.slice(1);d[e]=l}const M=a.indexOf(d3.max(a));T.innerHTML="",b.innerHTML="",h.innerHTML="",_.innerHTML="",y.innerHTML="",v.innerHTML="",H.innerHTML="",T.innerHTML="<th></th>";for(let e=0;e<d.length;e++)e===M?T.innerHTML+=`<th>${d[e]}&#129351;</th>`:T.innerHTML+=`<th>${d[e]}</th>`;b.innerHTML="<td>Best Round</td>";for(let e=0;e<r.length;e++)b.innerHTML+=`<td>${d3.max(r[e])}</td>`;h.innerHTML="<td>Avg Round</td>";for(let e=0;e<r.length;e++)h.innerHTML+=`<td>${Math.round(d3.mean(r[e])*10)/10}</td>`;_.innerHTML="<td>Std Dev</td>";for(let e=0;e<r.length;e++)_.innerHTML+=`<td>${Math.round(d3.deviation(r[e])*10)/10}</td>`;y.innerHTML="<td>Rounds Won<sup>*</sup></td>";for(let e=0;e<r.length;e++)y.innerHTML+=`<td>${m[e]}</td>`;if(c==="24-25"||c==="25-26"){v.innerHTML="<td>Correct Results</td>";for(let e=0;e<s.length;e++)v.innerHTML+=`<td>${s[e]}</td>`;H.innerHTML="<td>Correct Scores</td>";for(let e=0;e<o.length;e++)H.innerHTML+=`<td>${o[e]}</td>`}}
