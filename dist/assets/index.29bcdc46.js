(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function h(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=h(s);fetch(s.href,n)}})();const w="/super-six-tracker/assets/super-six-scores.29535599.csv",B="/super-six-tracker/assets/football.b99eb6b5.svg";document.querySelector("#app").innerHTML=`
  <div id="title">
    <img id="football" src="" alt="Logo" width="60" height="60"/>
    <h1>Super 6 League Tracker</h1>
  </div>
  <h2>QUE SERA SERA, WE'RE GOING TO WORMBELLY</h2>
  <div id="seasons">
    <label for="season">Season:</label>
    <select name="season" id="season-select">
      <option value="24-25" selected>2024/2025</option>
      <option value="23-24">2023/2024</option>
      <option value="22-23">2022/2023</option>
    </select>
  </div>
  <p>Click each name to toggle data series.</p>
  <div id="legend-container"></div>
  <div id="graph"><div>`;document.getElementById("football").src=B;const d={top:20,right:80,bottom:40,left:80},L=800-d.left-d.right,S=500-d.top-d.bottom,E=L/S;let u=null,g=null;function I(r,i){const h=window.innerWidth,o=window.innerHeight;return h/o>E?(i=S,r=L):(r=h+d.left,i=r/E),[r,i]}[u,g]=I();let $=`<table id="stats-table" width=${u*1.2}>
<thead>
    <tr id="name-header">
      <th></th>
    </tr>
</thead>
<tbody id="stats-rows">
    <tr id="max-round-score"></tr>
    <tr id="avg-round-score"></tr>
    <tr id="standard-dev"></tr>
    <tr id="rounds-won"></tr>
</tbody>
</table>`;const j=document.getElementById("season-select");j.addEventListener("change",R);R();function R(){document.getElementById("legend-container").innerHTML="",document.getElementById("graph").innerHTML="";const r=j.value;console.log(`Current season: ${r}`);const i=d3.select("#graph").append("svg").attr("width",`${u+d.left+d.right}px`).attr("height",`${g+d.top+d.bottom}px`).append("g").attr("transform",`translate(${d.left}, ${d.top})`),h=d3.select("#legend-container").style("width",`${u}px`);d3.csv(w).then(function(o){const s=["andy","david","jake","james","jonnie","josh","sam"],n=["andy","david","ed","jack","jake","james","jonnie","josh","sam"],m=["andy","david","ed","jack","jake","james","jonnie","josh","sam"];let f=null;switch(r){case"22-23":f=s.map(function(t){return{name:t,values:o.filter(function(l){return l.name===t}).map(function(l){return{round:+l.round,score:+l.score,score_sum:+l.score_sum}})}});break;case"23-24":f=n.map(function(t){return{name:t,values:o.filter(function(l){return l.s2_name===t}).map(function(l){return{round:+l.s2_round,score:+l.s2_score,score_sum:+l.s2_score_sum}})}});break;case"24-25":f=m.map(function(t){return{name:t,values:o.filter(function(l){return l.s3_name===t}).map(function(l){return{round:+l.s3_round,score:+l.s3_score,score_sum:+l.s3_score_sum,correct_results:+l.s3_correct_results,correct_scores:+l.s3_correct_scores}})}});break;default:console.log("No recognised season toggle!")}function H(){return d3.axisBottom(y).ticks()}function _(){return d3.axisLeft(x).ticks()}const y=d3.scaleLinear().domain(r==="22-23"?[1,d3.max(o,function(t){return+t.round})]:r==="23-24"?[1,d3.max(o,function(t){return+t.s2_round})]:[1,d3.max(o,function(t){return+t.s3_round})]).range([0,u]);i.append("g").attr("transform",`translate(0, ${g})`).style("font-size","0.75rem").call(d3.axisBottom(y).ticks(r==="22-23"?d3.max(o,function(t){return+t.round})/2:r==="23-24"?d3.max(o,function(t){return+t.s2_round})/2:d3.max(o,function(t){return+t.s3_round})/2)),i.append("g").attr("class","grid").attr("transform","translate(0,"+g+")").call(H().tickSize(-g).tickFormat("").ticks(d3.max(o,function(t){return r==="22-23"?+t.round:+t.s2_round})/2)),i.append("text").attr("text-anchor","center").attr("x",(u-50)/2).attr("y",g+d.bottom).text("Round");const x=d3.scaleLinear().domain([d3.min(o,function(t){return r==="22-23"?+t.score_sum:r==="23-24"?+t.s2_score_sum:+t.s3_score_sum}),Math.ceil(d3.max(o,function(t){return r==="22-23"?+t.score_sum:r==="23-24"?+t.s2_score_sum:+t.s3_score_sum})/10)*10]).range([g,0]);i.append("g").style("font-size","0.75rem").call(d3.axisLeft(x).ticks(u===L?d3.max(o,function(t){return+t.score_sum})/40:d3.max(o,function(t){return+t.score_sum})/40)),i.append("g").attr("class","grid").call(_().tickSize(-u).tickFormat("").ticks(u===L?d3.max(o,function(t){return+t.score_sum})/10:d3.max(o,function(t){return+t.score_sum})/10)),i.append("text").attr("text-anchor","center").attr("transform",u===L?"rotate(0)":"rotate(-90)").attr("x",u===L?-d.left:-g/2).attr("y",u===L?g/2:-d.top*2).text("Points");const v=d3.scaleOrdinal().domain(r==="22-23"?s:n).range(d3.schemeTableau10),T=d3.line().x(t=>y(+t.round)).y(t=>x(+t.score_sum)),b=i.selectAll("myLines").data(f).join("path").attr("d",t=>T(t.values)).attr("stroke",t=>v(t.name)).style("stroke-width",2).style("fill","none"),M=h.selectAll("myLabels").data(r==="22-23"?s:r==="23-24"?n:m).enter().append("div").attr("class","legend-label").style("color",t=>v(t)).text(function(t){return t}).style("alignment-baseline","middle").on("click",(t,l)=>{const e=M.selectAll("g")._parents;let c=null;for(let p=0;p<e.length;p++)if(l===e[p].innerHTML){c=e[p];break}const a=b.selectAll("path")._parents;let k=null;for(let p=0;p<a.length;p++)if(v(l)===a[p].attributes.stroke.value){k=a[p];break}d3.select(c).style("opacity",()=>d3.select(c).style("opacity")==="1"?"0.33":"1"),d3.select(k).style("opacity",()=>d3.select(k).style("opacity")==="1"?"0":"1")});N(f,r,$)})}function N(r,i,h){if(console.log("Updating the table."),document.getElementById("stats-table")===null&&(console.log("Table does not exist yet!"),d3.select("#app").append("div").html(h),d3.select("#app").append("p").html("* Includes tied winners.")),i==="24-25"){let e=document.getElementById("stats-rows");e.innerHTML+=`
    <tr id="correct-results"></tr>
    <tr id="correct-scores"></tr>`}const o=[],s=[];for(let e=0;e<r.length;e++)o.push(r[e].values.slice(-1)[0].correct_results),s.push(r[e].values.slice(-1)[0].correct_scores);const n=[];for(let e=0;e<r.length;e++){let c=[];for(let a=0;a<r[e].values.length;a++)c.push(r[e].values[a].score);n.push(c)}const m=[];for(let e=0;e<n.length;e++){let c=0;for(let a=0;a<n[e].length;a++)c+=n[e][a];m.push(c)}const f=[];for(let e=0;e<n[0].length;e++){let c=0;for(let a=0;a<n.length;a++)n[a][e]>c&&(c=n[a][e]);f.push(c)}let H=new Array(n.length).fill(0);for(let e=0;e<f.length;e++)for(let c=0;c<n.length;c++)n[c][e]===f[e]&&(H[c]+=1);const _=document.getElementById("name-header"),y=document.getElementById("max-round-score"),x=document.getElementById("avg-round-score"),v=document.getElementById("standard-dev"),T=document.getElementById("rounds-won"),b=document.getElementById("correct-results"),M=document.getElementById("correct-scores");let t=[];for(let e=0;e<r.length;e++)t.push(r[e].name);for(let e=0;e<t.length;e++){let c=t[e],a=c.charAt(0).toUpperCase()+c.slice(1);t[e]=a}const l=m.indexOf(d3.max(m));_.innerHTML="",y.innerHTML="",x.innerHTML="",v.innerHTML="",T.innerHTML="",b.innerHTML="",M.innerHTML="",_.innerHTML="<th></th>";for(let e=0;e<t.length;e++)e===l?_.innerHTML+=`<th>${t[e]}&#129351;</th>`:_.innerHTML+=`<th>${t[e]}</th>`;y.innerHTML="<td>Best Round</td>";for(let e=0;e<n.length;e++)y.innerHTML+=`<td>${d3.max(n[e])}</td>`;x.innerHTML="<td>Avg Round</td>";for(let e=0;e<n.length;e++)x.innerHTML+=`<td>${Math.round(d3.mean(n[e])*10)/10}</td>`;v.innerHTML="<td>Std Dev</td>";for(let e=0;e<n.length;e++)v.innerHTML+=`<td>${Math.round(d3.deviation(n[e])*10)/10}</td>`;T.innerHTML="<td>Rounds Won<sup>*</sup></td>";for(let e=0;e<n.length;e++)T.innerHTML+=`<td>${H[e]}</td>`;if(i==="24-25"){b.innerHTML="<td>Correct Results</td>";for(let e=0;e<o.length;e++)b.innerHTML+=`<td>${o[e]}</td>`;M.innerHTML="<td>Correct Scores</td>";for(let e=0;e<s.length;e++)M.innerHTML+=`<td>${s[e]}</td>`}}
